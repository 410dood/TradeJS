os:
  - osx
  - linux
osx_image: xcode8.3
dist: trusty
language: node_js
node_js:
  - 7.10.0

before_install:
  - brew update
#  - brew install gnu-tar graphicsmagick xz
#  - brew install wine --without-x11
#  - brew install mono

install:
  - cd client
  - npm install --silent
  - npm run build
  - cd ../server
  - npm install --silent
  - npm run build
  - cd ../electron
  - npm install --silent
  - node_modules/.bin/build --projectDir=../ --platform=all
#  - npm run build:windows

deploy:
  provider: releases
  api_key: "21674136073559d30642d0db6b9e7122a7eeb290"
  file: "./dist/TradeJS 0.0.1.dmg"
  skip_cleanup: true
  on:
    tags: true